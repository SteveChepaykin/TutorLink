(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[937],{285:(e,t,a)=>{"use strict";a.d(t,{$:()=>o});var r=a(5155),s=a(2115),n=a(9708),i=a(2085),l=a(9434);let c=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=s.forwardRef((e,t)=>{let{className:a,variant:s,size:i,asChild:o=!1,...d}=e,f=o?n.DX:"button";return(0,r.jsx)(f,{className:(0,l.cn)(c({variant:s,size:i,className:a})),ref:t,...d})});o.displayName="Button"},1816:(e,t,a)=>{Promise.resolve().then(a.bind(a,9318))},2523:(e,t,a)=>{"use strict";a.d(t,{p:()=>i});var r=a(5155),s=a(2115),n=a(9434);let i=s.forwardRef((e,t)=>{let{className:a,type:s,...i}=e;return(0,r.jsx)("input",{type:s,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...i})});i.displayName="Input"},5365:(e,t,a)=>{"use strict";a.d(t,{Fc:()=>c,TN:()=>d,XL:()=>o});var r=a(5155),s=a(2115),n=a(2085),i=a(9434);let l=(0,n.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),c=s.forwardRef((e,t)=>{let{className:a,variant:s,...n}=e;return(0,r.jsx)("div",{ref:t,role:"alert",className:(0,i.cn)(l({variant:s}),a),...n})});c.displayName="Alert";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",a),...s})});o.displayName="AlertTitle";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",a),...s})});d.displayName="AlertDescription"},6695:(e,t,a)=>{"use strict";a.d(t,{BT:()=>o,Wu:()=>d,ZB:()=>c,Zp:()=>i,aR:()=>l,wL:()=>f});var r=a(5155),s=a(2115),n=a(9434);let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});i.displayName="Card";let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",a),...s})});l.displayName="CardHeader";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",a),...s})});c.displayName="CardTitle";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...s})});o.displayName="CardDescription";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",a),...s})});d.displayName="CardContent";let f=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",a),...s})});f.displayName="CardFooter"},7416:(e,t,a)=>{"use strict";a.d(t,{O:()=>i,p:()=>l});let r=[],s=0,n=()=>"event-".concat(Date.now(),"-").concat(s++);async function i(e,t){await new Promise(e=>setTimeout(e,100));let a=r.filter(a=>{let r=a.start.getTime(),s=a.end.getTime(),n=e.getTime();return r<t.getTime()&&s>n});return console.log("Fetched ".concat(a.length," events for range: ").concat(e.toISOString()," - ").concat(t.toISOString())),a}async function l(e){await new Promise(e=>setTimeout(e,200));let t={...e,id:n()};return r.push(t),console.log("Event created and added to cache:",t),console.log("Current cache size:",r.length),t}},7481:(e,t,a)=>{"use strict";a.d(t,{dj:()=>u});var r=a(2115);let s=0,n=new Map,i=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},l=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?i(a):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},c=[],o={toasts:[]};function d(e){o=l(o,e),c.forEach(e=>{e(o)})}function f(e){let{...t}=e,a=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>d({type:"DISMISS_TOAST",toastId:a});return d({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||r()}}}),{id:a,dismiss:r,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function u(){let[e,t]=r.useState(o);return r.useEffect(()=>(c.push(t),()=>{let e=c.indexOf(t);e>-1&&c.splice(e,1)}),[e]),{...e,toast:f,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},8856:(e,t,a)=>{"use strict";a.d(t,{E:()=>n});var r=a(5155),s=a(9434);function n(e){let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,s.cn)("animate-pulse rounded-md bg-muted",t),...a})}},9318:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>P});var r=a(5155),s=a(7416),n=a(644),i=a(3941),l=a(6874),c=a.n(l),o=a(2115),d=a(5365),f=a(8856),u=a(7481),m=a(1133),x=a(6766),p=a(285),g=a(6695),h=a(7524),v=a(6021),b=a(7149),j=a(6273),N=a(5481),w=a(2132),y=a(286),_=a(6190);function S(e){var t;let{isScreenSharing:a,participants:s}=e,n=s.find(e=>!e.isVideoOff&&"1"!==e.id)||s[0];return(0,r.jsx)("div",{className:"conference-page__main-video-display relative aspect-video bg-muted rounded-lg overflow-hidden flex items-center justify-center text-muted-foreground",children:a?(0,r.jsxs)("div",{className:"conference-page__screen-share-notice w-full h-full flex flex-col items-center justify-center bg-primary/10",children:[(0,r.jsx)(h.A,{className:"w-16 h-16 text-primary mb-4"}),(0,r.jsx)("p",{className:"text-lg font-semibold",children:"Вы демонстрируете свой экран"}),(0,r.jsx)("p",{className:"text-sm",children:"Другие участники видят содержимое вашего экрана."})]}):n&&!n.isVideoOff?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x.default,{src:"https://picsum.photos/800/450?random=".concat(n.id),alt:"Видеопоток ".concat(n.name),fill:!0,style:{objectFit:"cover"},"data-ai-hint":"человек видеозвонок",className:"transition-opacity duration-300"}),(0,r.jsx)("div",{className:"conference-page__participant-name-overlay absolute bottom-2 left-2 bg-black/50 text-white px-2 py-1 rounded text-sm",children:n.name})]}):(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)(v.A,{className:"w-16 h-16 mb-2"}),(0,r.jsx)("span",{children:null!==(t=null==n?void 0:n.name)&&void 0!==t?t:"Видео выключено"})]})})}function T(e){let{activeConferenceTitle:t,participants:a,isMuted:s,isVideoOff:n,isScreenSharing:i,showParticipantsPanel:l,onToggleMute:c,onToggleVideo:o,onToggleScreenShare:d,onToggleParticipantList:f,onLeaveCall:u}=e;return(0,r.jsx)("div",{className:"conference-page__main-area flex-grow flex flex-col",children:(0,r.jsxs)(g.Zp,{className:"conference-page__video-card flex-grow flex flex-col shadow-lg overflow-hidden",children:[(0,r.jsx)(g.aR,{className:"conference-page__video-card-header pb-2",children:(0,r.jsx)(g.ZB,{className:"conference-page__video-card-title text-primary",children:t})}),(0,r.jsx)(g.Wu,{className:"conference-page__video-card-content flex-grow p-2 relative",children:(0,r.jsx)(S,{isScreenSharing:i,participants:a})}),(0,r.jsxs)(g.wL,{className:"conference-page__controls-footer bg-secondary/30 p-2 flex justify-center gap-2 border-t",children:[(0,r.jsx)(p.$,{variant:s?"destructive":"outline",size:"icon",onClick:c,"aria-label":s?"Включить звук":"Выключить звук",children:s?(0,r.jsx)(b.A,{}):(0,r.jsx)(j.A,{})}),(0,r.jsx)(p.$,{variant:n?"destructive":"outline",size:"icon",onClick:o,"aria-label":n?"Включить видео":"Выключить видео",children:n?(0,r.jsx)(v.A,{}):(0,r.jsx)(N.A,{})}),(0,r.jsx)(p.$,{variant:i?"default":"outline",size:"icon",onClick:d,"aria-label":i?"Остановить демонстрацию":"Демонстрация экрана",children:i?(0,r.jsx)(w.A,{}):(0,r.jsx)(h.A,{})}),(0,r.jsx)(p.$,{variant:"outline",size:"icon",onClick:f,"aria-label":l?"Скрыть участников":"Показать участников",children:(0,r.jsx)(y.A,{})}),(0,r.jsx)(p.$,{variant:"destructive",size:"icon",onClick:u,"aria-label":"Покинуть звонок",children:(0,r.jsx)(_.A,{})})]})]})})}var A=a(5977),O=a(9434);let k=o.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(A.bL,{ref:t,className:(0,O.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...s})});k.displayName=A.bL.displayName;let M=o.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(A._V,{ref:t,className:(0,O.cn)("aspect-square h-full w-full",a),...s})});M.displayName=A._V.displayName;let R=o.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(A.H4,{ref:t,className:(0,O.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...s})});R.displayName=A.H4.displayName;var E=a(2523),D=a(9051);let C=o.forwardRef((e,t)=>{let{className:a,children:s,...n}=e;return(0,r.jsxs)(D.bL,{ref:t,className:(0,O.cn)("relative overflow-hidden",a),...n,children:[(0,r.jsx)(D.LM,{className:"h-full w-full rounded-[inherit]",children:s}),(0,r.jsx)(V,{}),(0,r.jsx)(D.OK,{})]})});C.displayName=D.bL.displayName;let V=o.forwardRef((e,t)=>{let{className:a,orientation:s="vertical",...n}=e;return(0,r.jsx)(D.VM,{ref:t,orientation:s,className:(0,O.cn)("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...n,children:(0,r.jsx)(D.lr,{className:"relative flex-1 rounded-full bg-border"})})});V.displayName=D.VM.displayName;var I=a(4063),L=a(3672);function z(e){let{chatMessages:t,participants:a,showParticipantsPanel:s,onSendMessage:n,onToggleParticipantList:i}=e,[l,c]=o.useState(""),d=o.useRef(null);return o.useEffect(()=>{if(d.current){let e=d.current.querySelector("[data-radix-scroll-area-viewport]");e&&(e.scrollTop=e.scrollHeight)}},[t]),(0,r.jsxs)(g.Zp,{className:(0,O.cn)("conference-page__sidebar lg:w-80 flex flex-col shadow-lg transition-all duration-300 ease-in-out",s?"block":"hidden lg:flex"),children:[(0,r.jsxs)(g.aR,{className:"conference-page__sidebar-header flex flex-row items-center justify-between pb-2 border-b",children:[(0,r.jsxs)(g.ZB,{className:"conference-page__sidebar-title text-lg text-primary",children:[s?"Участники":"Чат"," (",s?a.length:t.length,")"]}),(0,r.jsx)(p.$,{variant:"ghost",size:"icon",onClick:i,className:"lg:hidden",children:s?(0,r.jsx)(I.A,{}):(0,r.jsx)(y.A,{})})]}),s?(0,r.jsxs)(C,{className:"conference-page__participants-list-scroll-area flex-grow p-4",children:[(0,r.jsx)("div",{className:"conference-page__participants-list flex gap-4 pb-4 overflow-x-auto",children:a.map(e=>(0,r.jsxs)("div",{className:"conference-page__participant-item flex flex-col items-center gap-2 w-24 flex-shrink-0",children:[(0,r.jsxs)(k,{className:"h-12 w-12",children:[(0,r.jsx)(M,{src:e.avatar,alt:e.name,"data-ai-hint":"аватар пользователь"}),(0,r.jsx)(R,{children:e.name.charAt(0)}),e.isMuted&&(0,r.jsx)(b.A,{className:"absolute bottom-0 right-0 h-4 w-4 text-red-500 bg-background/80 rounded-full p-0.5"}),!e.isVideoOff&&(0,r.jsx)(N.A,{className:"absolute top-0 right-0 h-4 w-4 text-green-500 bg-background/80 rounded-full p-0.5"}),e.isVideoOff&&(0,r.jsx)(v.A,{className:"absolute top-0 right-0 h-4 w-4 text-muted-foreground bg-background/80 rounded-full p-0.5"})]}),(0,r.jsx)("span",{className:"text-sm font-medium text-center truncate w-full",children:e.name})]},e.id))}),0===a.length&&(0,r.jsx)("p",{className:"text-sm text-muted-foreground text-center",children:"Нет других участников."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(C,{className:"conference-page__chat-messages-scroll-area flex-grow p-4",ref:d,children:(0,r.jsxs)("div",{className:"conference-page__chat-messages-list space-y-4",children:[t.map((e,t)=>(0,r.jsx)("div",{className:"conference-page__chat-message-item flex ".concat("Вы"===e.sender?"justify-end":"justify-start"),children:(0,r.jsxs)("div",{className:"p-2 rounded-lg max-w-[80%] ".concat("Вы"===e.sender?"bg-primary/20":"bg-secondary/20"),children:[(0,r.jsx)("p",{className:"text-xs font-semibold mb-1",children:e.sender}),(0,r.jsx)("p",{className:"text-sm",children:e.text}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground text-right mt-1",children:new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},t)),0===t.length&&(0,r.jsx)("p",{className:"text-sm text-muted-foreground text-center",children:"Сообщения чата будут отображаться здесь."})]})}),(0,r.jsx)(g.wL,{className:"conference-page__chat-input-footer p-2 border-t",children:(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),l.trim()&&(n([...t,{sender:"Вы",text:l,timestamp:Date.now()}]),c(""))},className:"conference-page__chat-form flex w-full gap-2",children:[(0,r.jsx)(E.p,{placeholder:"Введите сообщение...",value:l,onChange:e=>c(e.target.value),className:"flex-grow"}),(0,r.jsx)(p.$,{type:"submit",size:"icon","aria-label":"Отправить сообщение",children:(0,r.jsx)(L.A,{})})]})})]})]})}function P(){let[e,t]=o.useState(!1),[a,l]=o.useState(!1),[x,p]=o.useState(!1),[g,h]=o.useState([]),[v,b]=o.useState([{id:"1",name:"Вы",avatar:"https://picsum.photos/50/50?random=1",isMuted:!1,isVideoOff:!1},{id:"2",name:"Алиса",avatar:"https://picsum.photos/50/50?random=2",isMuted:!0,isVideoOff:!1},{id:"3",name:"Борис",avatar:"https://picsum.photos/50/50?random=3",isMuted:!1,isVideoOff:!0},{id:"4",name:"Сергей",avatar:"https://picsum.photos/50/50?random=4",isMuted:!1,isVideoOff:!1},{id:"5",name:"Елена",avatar:"https://picsum.photos/50/50?random=5",isMuted:!1,isVideoOff:!1}]),[j,N]=o.useState(!1),{toast:w}=(0,u.dj)(),[y,_]=o.useState(null),[S,A]=o.useState(!0),[O,k]=o.useState("Видеоконференция");return(o.useEffect(()=>{(async function(){A(!0);try{let e=new Date,t=(0,n.o)(e),a=(0,i.D)(e),r=(await (0,s.O)(t,a)).map(e=>({...e,start:new Date(e.start),end:new Date(e.end)})).find(t=>t.start<=e&&t.end>=e);r?(_(!0),k(r.title)):_(!1)}catch(e){console.error("Ошибка при проверке активных конференций:",e),w({title:"Ошибка",description:"Не удалось проверить наличие активных конференций.",variant:"destructive"}),_(!1)}finally{A(!1)}})()},[w]),o.useEffect(()=>{if(!y)return;let e=setTimeout(()=>{if(Math.random()>.7){let e=v[Math.floor(Math.random()*(v.length-1))+1];if(e){let t={sender:e.name,text:"Привет!",timestamp:Date.now()};h(e=>[...e,t])}}},5e3+5e3*Math.random());return()=>clearTimeout(e)},[g,v,y]),S)?(0,r.jsxs)("div",{className:"conference-page conference-page--loading flex flex-col items-center justify-center h-[calc(100vh-10rem)]",children:[(0,r.jsx)(f.E,{className:"h-12 w-3/4 mb-4"}),(0,r.jsx)(f.E,{className:"h-8 w-1/2 mb-2"}),(0,r.jsx)("p",{className:"text-muted-foreground text-lg",children:"Проверка наличия активных конференций..."})]}):y?(0,r.jsxs)("div",{className:"conference-page flex flex-col lg:flex-row gap-4 h-[calc(100vh-10rem)] max-h-[800px]",children:[(0,r.jsx)(T,{activeConferenceTitle:O,participants:v,isMuted:e,isVideoOff:a,isScreenSharing:x,showParticipantsPanel:j,onToggleMute:()=>t(!e),onToggleVideo:()=>l(!a),onToggleScreenShare:()=>{p(!x),w({title:x?"Демонстрация экрана остановлена":"Демонстрация экрана запущена",description:x?"Вы больше не показываете свой экран.":"Вы начали демонстрацию экрана."})},onToggleParticipantList:()=>N(!j),onLeaveCall:()=>{w({title:"Звонок завершен",description:"Вы покинули конференцию."})}}),(0,r.jsx)(z,{chatMessages:g,participants:v,showParticipantsPanel:j,onSendMessage:e=>h(e),onToggleParticipantList:()=>N(!j)})]}):(0,r.jsx)("div",{className:"conference-page conference-page--no-active flex flex-col items-center justify-center h-[calc(100vh-10rem)] p-8 text-center",children:(0,r.jsxs)(d.Fc,{variant:"default",className:"max-w-md",children:[(0,r.jsx)(m.A,{className:"h-6 w-6"}),(0,r.jsx)(d.XL,{className:"text-xl font-semibold mt-2",children:"Нет активных конференций"}),(0,r.jsxs)(d.TN,{className:"mt-2 text-base",children:["В данный момент нет активных конференций. Пожалуйста, проверьте"," ",(0,r.jsx)(c(),{href:"/calendar",className:"text-primary underline hover:text-primary/80",children:"календарь"})," ","для просмотра расписания."]})]})})}},9434:(e,t,a)=>{"use strict";a.d(t,{cn:()=>n});var r=a(2596),s=a(9688);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.QP)((0,r.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[668,874,966,441,684,358],()=>t(1816)),_N_E=e.O()}]);