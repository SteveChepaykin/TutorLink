(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[384],{1133:(e,a,s)=>{"use strict";s.d(a,{A:()=>t});let t=(0,s(157).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},1223:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>N});var t=s(5155),r=s(1281),l=s(2115),i=s(7481),c=s(8856),d=s(5365),n=s(157);let o=(0,n.A)("School",[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 3.447 1.724a1 1 0 0 1 .553.894V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-7.382a1 1 0 0 1 .553-.894L6 10",key:"1xqip1"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 7.106-3.553a2 2 0 0 1 1.788 0L20 6",key:"9d2mlk"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]);var h=s(1133),x=s(6874),m=s.n(x),u=s(6695);function v(e){let{currentUser:a}=e;return(0,t.jsx)(u.Zp,{className:"teachers-page__header-card bg-card/80 backdrop-blur-sm",children:(0,t.jsxs)(u.aR,{children:[(0,t.jsx)(u.ZB,{className:"text-2xl text-primary",children:"Список преподавателей"}),(0,t.jsxs)(u.BT,{children:["Выберите преподавателя, чтобы записаться на его курс.",(null==a?void 0:a.teacherName)&&"Преподаватель не назначен"!==a.teacherName&&(0,t.jsxs)("span",{children:[" Ваш текущий преподаватель: ",(0,t.jsx)("strong",{children:a.teacherName}),"."]}),(null==a?void 0:a.teacherName)==="Преподаватель не назначен"&&(0,t.jsx)("span",{children:" У вас пока нет назначенного преподавателя."})]})]})})}var p=s(285);let g=(0,n.A)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);function f(e){var a;let{teacher:s,currentUser:r,isEnrolling:l,onEnroll:i}=e,c=(null==r?void 0:r.teacherName)===s.name;return(0,t.jsxs)(u.Zp,{className:"teachers-page__teacher-card shadow-lg flex flex-col",children:[(0,t.jsxs)(u.aR,{children:[(0,t.jsx)(u.ZB,{className:"text-xl text-primary",children:s.name}),(0,t.jsxs)(u.BT,{className:"text-base",children:["Предмет: ",s.subject||"Не указан"]})]}),(0,t.jsx)(u.Wu,{className:"flex-grow",children:(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Студентов: ",(null===(a=s.students)||void 0===a?void 0:a.length)||0]})}),(0,t.jsx)(u.wL,{children:(null==r?void 0:r.role)==="student"&&(c?(0,t.jsxs)(p.$,{variant:"outline",disabled:!0,className:"w-full",children:[(0,t.jsx)(g,{className:"mr-2 h-4 w-4"}),"Вы записаны"]}):(0,t.jsx)(p.$,{onClick:()=>i(s.id),disabled:l||!r,className:"w-full",children:l?"Запись...":"Записаться"}))})]},s.id)}function N(){let[e,a]=l.useState(null),[s,n]=l.useState([]),[x,u]=l.useState(!0),[p,g]=l.useState(!0),[N,j]=l.useState({}),{toast:y}=(0,i.dj)();l.useEffect(()=>{!async function(){u(!0),g(!0);try{let[e,s]=await Promise.all([(0,r.HW)(),(0,r.Gi)()]);a(e),n(s)}catch(e){console.error("Ошибка загрузки данных:",e),y({title:"Ошибка",description:"Не удалось загрузить данные. Попробуйте обновить страницу.",variant:"destructive"})}finally{u(!1),g(!1)}}()},[y]);let k=async t=>{var l,i;if(!e||"student"!==e.role){y({title:"Действие запрещено",description:"Только студенты могут записываться к преподавателям.",variant:"destructive"});return}if(e.teacherName&&(null===(l=s.find(e=>e.id===t))||void 0===l?void 0:l.name)===e.teacherName){y({title:"Информация",description:"Вы уже записаны к этому преподавателю."});return}j(e=>({...e,[t]:!0}));try{let l=await (0,r.A0)(e.id,t);a(l),y({title:"Успех!",description:"Вы успешно записались к преподавателю ".concat(null===(i=s.find(e=>e.id===t))||void 0===i?void 0:i.name,".")})}catch(e){console.error("Ошибка записи к преподавателю:",e),y({title:"Ошибка записи",description:e.message||"Не удалось записаться к преподавателю.",variant:"destructive"})}finally{j(e=>({...e,[t]:!1}))}};return x||p?(0,t.jsxs)("div",{className:"teachers-page teachers-page--loading space-y-6",children:[(0,t.jsx)(c.E,{className:"h-24 w-full"})," ",(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(e=>(0,t.jsx)(c.E,{className:"h-48 w-full"},e))})]}):(null==e?void 0:e.role)==="teacher"?(0,t.jsx)("div",{className:"teachers-page teachers-page--teacher-view",children:(0,t.jsxs)(d.Fc,{variant:"default",className:"max-w-md mx-auto",children:[(0,t.jsx)(o,{className:"h-6 w-6"}),(0,t.jsx)(d.XL,{className:"text-xl font-semibold mt-2",children:"Список преподавателей"}),(0,t.jsxs)(d.TN,{className:"mt-2 text-base",children:["Эта страница предназначена для студентов. Преподаватели не могут записываться на курсы. Вы можете управлять своим списком студентов на странице"," ",(0,t.jsx)(m(),{href:"/profile",className:"text-primary underline hover:text-primary/80",children:"профиля"}),"."]})]})}):(0,t.jsxs)("div",{className:"teachers-page space-y-6",children:[(0,t.jsx)(v,{currentUser:e}),0===s.length&&!p&&(0,t.jsxs)(d.Fc,{className:"teachers-page__no-teachers-alert",children:[(0,t.jsx)(h.A,{className:"h-4 w-4"}),(0,t.jsx)(d.XL,{children:"Нет доступных преподавателей"}),(0,t.jsx)(d.TN,{children:"В данный момент нет доступных преподавателей. Пожалуйста, проверьте позже."})]}),(0,t.jsx)("div",{className:"teachers-page__list grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(a=>(0,t.jsx)(f,{teacher:a,currentUser:e,isEnrolling:N[a.id]||!1,onEnroll:k},a.id))})]})}},5365:(e,a,s)=>{"use strict";s.d(a,{Fc:()=>d,TN:()=>o,XL:()=>n});var t=s(5155),r=s(2115),l=s(2085),i=s(9434);let c=(0,l.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),d=r.forwardRef((e,a)=>{let{className:s,variant:r,...l}=e;return(0,t.jsx)("div",{ref:a,role:"alert",className:(0,i.cn)(c({variant:r}),s),...l})});d.displayName="Alert";let n=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("h5",{ref:a,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",s),...r})});n.displayName="AlertTitle";let o=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)("div",{ref:a,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",s),...r})});o.displayName="AlertDescription"},6189:(e,a,s)=>{Promise.resolve().then(s.bind(s,1223))}},e=>{var a=a=>e(e.s=a);e.O(0,[668,874,582,441,684,358],()=>a(6189)),_N_E=e.O()}]);