(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[636],{1345:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>E});var r=a(5155),l=a(1281),t=a(2115),i=a(7481),c=a(8856),n=a(6695),d=a(285),o=a(2523),m=a(5057),u=a(6072),p=a(154),x=a(9434);let f=t.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsx)(u.bL,{className:(0,x.cn)("grid gap-2",a),...l,ref:s})});f.displayName=u.bL.displayName;let h=t.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsx)(u.q7,{ref:s,className:(0,x.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),...l,children:(0,r.jsx)(u.C1,{className:"flex items-center justify-center",children:(0,r.jsx)(p.A,{className:"h-2.5 w-2.5 fill-current text-current"})})})});function j(e){let{user:s,currentName:a,currentRole:l,isSaving:t,onSave:i,onNameChange:c,onRoleChange:u}=e,p=(a!==s.name||l!==s.role)&&!!l&&""!==a.trim();return(0,r.jsxs)(n.Zp,{className:"profile-page__edit-card shadow-lg",children:[(0,r.jsxs)(n.aR,{className:"profile-page__edit-card-header",children:[(0,r.jsx)(n.ZB,{className:"profile-page__edit-card-title text-primary",children:"Редактировать профиль"}),(0,r.jsx)(n.BT,{className:"profile-page__edit-card-description",children:"Обновите ваше имя и статус."})]}),(0,r.jsxs)(n.Wu,{className:"profile-page__edit-card-content space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(m.J,{htmlFor:"name",children:"Имя"}),(0,r.jsx)(o.p,{id:"name",value:a,onChange:e=>c(e.target.value),disabled:t})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(m.J,{children:"Статус"}),(0,r.jsxs)(f,{value:l,onValueChange:e=>u(e),className:"flex space-x-4",disabled:t,children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(h,{value:"teacher",id:"role-teacher"}),(0,r.jsx)(m.J,{htmlFor:"role-teacher",children:"Репетитор"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(h,{value:"student",id:"role-student"}),(0,r.jsx)(m.J,{htmlFor:"role-student",children:"Студент"})]})]})]})]}),(0,r.jsx)(n.wL,{className:"profile-page__edit-card-footer",children:(0,r.jsx)(d.$,{onClick:()=>{l&&i(a,l)},disabled:t||!p,children:t?"Сохранение...":"Сохранить изменения"})})]})}h.displayName=u.q7.displayName;let N=t.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsx)("ul",{ref:s,className:(0,x.cn)("space-y-2 list-disc list-inside text-sm",a),...l})});N.displayName="List";let g=t.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsx)("li",{ref:s,className:(0,x.cn)("text-muted-foreground",a),...l})});g.displayName="ListItem";var b=a(3896);function v(e){let{teacherId:s}=e,[a,u]=t.useState([]),[p,x]=t.useState(""),[f,h]=t.useState(!0),[j,v]=t.useState(!1),{toast:y}=(0,i.dj)(),w=t.useCallback(async()=>{h(!0);try{let e=await (0,l.iM)(s);u(e)}catch(e){console.error("Ошибка загрузки списка студентов:",e),y({title:"Ошибка",description:"Не удалось загрузить список студентов.",variant:"destructive"}),u([])}finally{h(!1)}},[s,y]);t.useEffect(()=>{s&&w()},[s,w]);let _=async()=>{if(p.trim()){v(!0);try{let e=await (0,l.W6)(p.trim());u(e),x(""),y({title:"Студент добавлен",description:'Студент "'.concat(p.trim(),'" успешно добавлен/обновлен в вашем списке.')})}catch(e){console.error("Ошибка добавления студента:",e),y({title:"Ошибка",description:e.message||"Не удалось добавить студента.",variant:"destructive"})}finally{v(!1)}}};return(0,r.jsxs)(n.Zp,{className:"profile-page__student-list-card shadow-lg",children:[(0,r.jsxs)(n.aR,{className:"profile-page__student-list-card-header",children:[(0,r.jsx)(n.ZB,{className:"profile-page__student-list-card-title text-primary",children:"Ваши студенты"}),(0,r.jsx)(n.BT,{className:"profile-page__student-list-card-description",children:"Список студентов, связанных с вашим аккаунтом репетитора."})]}),(0,r.jsxs)(n.Wu,{className:"profile-page__student-list-card-content space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(m.J,{htmlFor:"new-student",children:"Добавить нового студента"}),(0,r.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,r.jsx)(o.p,{id:"new-student",value:p,onChange:e=>x(e.target.value),placeholder:"Имя студента",disabled:j,className:"flex-grow"}),(0,r.jsx)(d.$,{onClick:_,disabled:j||!p.trim(),size:"icon","aria-label":"Добавить студента",children:j?(0,r.jsx)("span",{className:"animate-spin h-4 w-4 border-2 border-background border-t-transparent rounded-full"}):(0,r.jsx)(b.A,{className:"h-5 w-5"})})]})]}),f?(0,r.jsxs)("div",{className:"space-y-2 pt-2",children:[(0,r.jsx)(c.E,{className:"h-6 w-3/4"}),(0,r.jsx)(c.E,{className:"h-6 w-2/3"}),(0,r.jsx)(c.E,{className:"h-6 w-4/5"})]}):a.length>0?(0,r.jsx)(N,{className:"profile-page__student-list pt-2",children:a.map((e,s)=>(0,r.jsx)(g,{className:"profile-page__student-list-item border-b py-1.5 last:border-b-0",children:e},s))}):(0,r.jsx)("p",{className:"text-muted-foreground pt-2 text-sm",children:"У вас пока нет студентов."})]})]})}var y=a(6874),w=a.n(y);function _(e){let{teacherName:s}=e;return(0,r.jsxs)("div",{className:"profile-page__student-teacher-info space-y-2 pt-2",children:[(0,r.jsx)(m.J,{children:"Ваш преподаватель"}),(0,r.jsx)("div",{className:"text-sm text-muted-foreground p-3 border rounded-md bg-secondary/20",children:s&&"Преподаватель не назначен"!==s?s:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{children:"Преподаватель не назначен. "}),(0,r.jsx)(w(),{href:"/teachers",className:"text-primary hover:underline",children:"Выбрать преподавателя?"})]})})]})}function E(){let[e,s]=t.useState(null),[a,d]=t.useState(""),[o,m]=t.useState(void 0),[u,p]=t.useState(!0),[x,f]=t.useState(!1),{toast:h}=(0,i.dj)(),N=t.useCallback(async()=>{p(!0);try{let e=await (0,l.HW)();s(e),d(e.name),m(e.role)}catch(e){console.error("Ошибка загрузки данных пользователя:",e),h({title:"Ошибка",description:"Не удалось загрузить данные профиля.",variant:"destructive"})}finally{p(!1)}},[h]);t.useEffect(()=>{N()},[N]);let g=async(a,r)=>{if(e){f(!0);try{let e=await (0,l.TK)({name:a,role:r});s(e),d(e.name),m(e.role),await N(),h({title:"Успех",description:"Ваш профиль успешно обновлен."})}catch(s){console.error("Ошибка обновления профиля:",s),h({title:"Ошибка",description:"Не удалось обновить профиль.",variant:"destructive"}),e&&(d(e.name),m(e.role))}finally{f(!1)}}};return u?(0,r.jsxs)("div",{className:"profile-page profile-page--loading space-y-6 max-w-2xl mx-auto",children:[(0,r.jsxs)(n.Zp,{className:"shadow-lg",children:[(0,r.jsxs)(n.aR,{children:[(0,r.jsx)(c.E,{className:"h-8 w-1/3"}),(0,r.jsx)(c.E,{className:"h-5 w-1/2"})]}),(0,r.jsxs)(n.Wu,{className:"space-y-4",children:[(0,r.jsx)(c.E,{className:"h-10 w-full"}),(0,r.jsx)(c.E,{className:"h-10 w-full"}),(0,r.jsx)(c.E,{className:"h-10 w-full"})]}),(0,r.jsx)(n.wL,{children:(0,r.jsx)(c.E,{className:"h-10 w-28"})})]}),(0,r.jsxs)(n.Zp,{className:"shadow-lg",children:[(0,r.jsx)(n.aR,{children:(0,r.jsx)(c.E,{className:"h-8 w-1/3"})}),(0,r.jsx)(n.Wu,{children:(0,r.jsx)(c.E,{className:"h-20 w-full"})})]})]}):e?(0,r.jsxs)("div",{className:"profile-page space-y-6 max-w-2xl mx-auto",children:[(0,r.jsx)(j,{user:e,currentName:a,currentRole:o,isSaving:x,onSave:g,onNameChange:d,onRoleChange:m}),"student"===o&&e&&(0,r.jsx)(_,{teacherName:e.teacherName}),"teacher"===o&&e&&(0,r.jsx)(v,{teacherId:e.id},e.id)]}):(0,r.jsx)("p",{className:"profile-page profile-page--error text-center text-destructive",children:"Не удалось загрузить данные профиля."})}},2523:(e,s,a)=>{"use strict";a.d(s,{p:()=>i});var r=a(5155),l=a(2115),t=a(9434);let i=l.forwardRef((e,s)=>{let{className:a,type:l,...i}=e;return(0,r.jsx)("input",{type:l,className:(0,t.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s,...i})});i.displayName="Input"},5057:(e,s,a)=>{"use strict";a.d(s,{J:()=>d});var r=a(5155),l=a(2115),t=a(968),i=a(2085),c=a(9434);let n=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsx)(t.b,{ref:s,className:(0,c.cn)(n(),a),...l})});d.displayName=t.b.displayName},6101:(e,s,a)=>{Promise.resolve().then(a.bind(a,1345))}},e=>{var s=s=>e(e.s=s);e.O(0,[668,874,29,582,441,684,358],()=>s(6101)),_N_E=e.O()}]);